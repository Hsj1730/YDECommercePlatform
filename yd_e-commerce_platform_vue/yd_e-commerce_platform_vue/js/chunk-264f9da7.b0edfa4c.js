(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-264f9da7"],{2075:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return"image"===t.type?a("div",[t._l(t.value,(function(e,i){return a("ul",{key:i,staticClass:"el-upload-list el-upload-list--picture-card"},[a("li",{staticClass:"el-upload-list__item is-ready",style:"width: "+t.width+"px;height: "+t.height+"px",attrs:{tabindex:"0"}},[a("div",[a("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:e.realUrl,alt:""}}),a("span",{staticClass:"el-upload-list__item-actions"},[0!==i?a("span",{staticClass:"el-upload-list__item-preview",on:{click:function(e){return t.moveMaterial(i,"up")}}},[a("i",{staticClass:"el-icon-back"})]):t._e(),a("span",{staticClass:"el-upload-list__item-preview",on:{click:function(e){return t.zoomMaterial(i)}}},[a("i",{staticClass:"el-icon-view"})]),a("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){return t.deleteMaterial(i)}}},[a("i",{staticClass:"el-icon-delete"})]),i!==t.value.length-1?a("span",{staticClass:"el-upload-list__item-preview",on:{click:function(e){return t.moveMaterial(i,"down")}}},[a("i",{staticClass:"el-icon-right"})]):t._e()])])])])})),t.num>t.value.length?a("div",{staticClass:"el-upload el-upload--picture-card",style:"width: "+t.width+"px;height: "+t.height+"px;line-height:"+t.height+"px;",attrs:{tabindex:"0"},on:{click:t.toSelectMaterial}},[a("i",{staticClass:"el-icon-plus"})]):t._e(),a("el-dialog",{attrs:{"append-to-body":"",visible:t.dialogVisible,width:"35%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{staticStyle:{width:"100%"},attrs:{src:t.url,alt:""}})]),a("el-dialog",{staticStyle:{"padding-bottom":"5vh"},attrs:{title:"图片素材库","append-to-body":"",visible:t.listDialogVisible,width:"70%",top:"5vh"},on:{"update:visible":function(e){t.listDialogVisible=e}}},[a("el-container",[a("el-aside",{attrs:{width:"unset"}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-button",{staticClass:"el-icon-plus",attrs:{size:"small"},on:{click:function(e){return t.materialGroupAdd()}}},[t._v(" 添加分组 ")])],1),a("el-tabs",{directives:[{name:"loading",rawName:"v-loading",value:t.materialGroupLoading,expression:"materialGroupLoading"}],attrs:{"tab-position":"left"},on:{"tab-click":t.tabClick},model:{value:t.materialGroupObjId,callback:function(e){t.materialGroupObjId=e},expression:"materialGroupObjId"}},t._l(t.materialGroupList,(function(e){return a("el-tab-pane",{key:e.id,attrs:{name:e.id+""}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(e.name))])])})),1)],1),a("el-main",{staticStyle:{"margin-top":"-20px"}},[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("el-row",[a("el-col",{attrs:{span:12}},[a("span",[t._v(t._s(t.materialGroupObj.name))]),0!==t.materialGroupObj.id?a("span",[a("el-button",{staticClass:"el-icon-edit",staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"text"},on:{click:function(e){return t.materialGroupEdit(t.materialGroupObj)}}},[t._v("重命名")]),a("el-button",{staticClass:"el-icon-delete",staticStyle:{"margin-left":"10px",color:"red"},attrs:{size:"small",type:"text"},on:{click:function(e){return t.materialGroupDelete(t.materialGroupObj)}}},[t._v("删除")])],1):t._e()]),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[a("el-upload",{attrs:{action:this.$axios.defaults.baseURL+"/material/uploadMaterial",headers:t.headers,"file-list":[],"before-upload":t.beforeUpload,"on-success":t.handleSuccess,"on-error":t.handleError,multiple:""}},[a("span",{staticStyle:{"margin-right":"10px","font-size":"14px"}},[t._v(" 可选照片数："),a("span",{staticStyle:{color:"red"}},[t._v(t._s(t.num-t.value.length-t.urls.length))]),t._v(" 张")]),a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("批量上传")])],1)],1)],1)],1),a("div",{attrs:{"v-loading":t.tableLoading}},[t.tableData.length<=0?a("el-alert",{attrs:{title:"暂无数据",type:"info",closable:!1,center:"","show-icon":""}}):t._e(),a("el-row",{attrs:{gutter:5}},[a("el-checkbox-group",{attrs:{max:t.num-t.value.length},model:{value:t.urls,callback:function(e){t.urls=e},expression:"urls"}},t._l(t.tableData,(function(e,i){return a("el-col",{key:i,attrs:{span:4}},[a("el-card",{attrs:{"body-style":{padding:"5px"}}},[a("el-image",{staticStyle:{width:"100%",height:"100px"},attrs:{src:e.realUrl,fit:"contain","preview-src-list":[e.realUrl],"z-index":999}}),a("div",[a("el-checkbox",{staticClass:"material-name",attrs:{label:e}},[t._v(" 选择 ")]),a("el-row",[a("el-col",{staticClass:"col-do",attrs:{span:24}},[a("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(a){return t.materialDel(e)}}},[t._v("删除")])],1)],1)],1)],1)],1)})),1)],1),a("el-pagination",{staticClass:"pagination",attrs:{"current-page":t.page.currentPage,"page-sizes":[12,24],"page-size":t.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.page.total},on:{"update:currentPage":function(e){return t.$set(t.page,"currentPage",e)},"update:current-page":function(e){return t.$set(t.page,"currentPage",e)},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.listDialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.sureUrls}},[t._v("确 定")])],1)],1)],2):t._e()},r=[],l=(a("a9e3"),a("d3b7"),a("159b"),a("b0c0"),a("ac1f"),a("00b4"),a("a434"),a("498a"),a("5f87")),n={name:"materialList",props:{value:{type:Array,default:function(){return[]}},type:{type:String},num:{type:Number,default:function(){return 5}},width:{type:Number,default:function(){return 150}},height:{type:Number,default:function(){return 150}}},data:function(){return{headers:{Authorization:Object(l["a"])()},dialogVisible:!1,listDialogVisible:!1,materialGroupLoading:!1,url:"",urls:[],tableData:[],materialGroupList:[],materialGroupObj:{},materialGroupObjId:"0",page:{total:0,current:1,pageSize:12},groupId:0,resultNumber:0,tableLoading:!1}},methods:{sureUrls:function(){var t=this;this.urls.forEach((function(e){t.$set(t.value,t.value.length,e)})),this.urls=[],this.listDialogVisible=!1},handleSizeChange:function(t){this.page.pageSize=t,this.getMaterialPageList()},handleCurrentChange:function(t){this.page.current=t,this.getMaterialPageList()},materialDel:function(t){var e=this,a=this;this.$confirm("是否确认删除该素材？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$axios({method:"post",url:"/material/deleteMaterial",data:{id:t.id,url:t.url}}).then((function(){a.getMaterialPageList()}))}))},handleSuccess:function(t,e,a){var i=this,r=this;this.$axios({method:"post",url:"/material/addMaterial",data:{groupId:this.groupId,name:e.name,url:t.data.data,type:"1"}}).then((function(){i.resultNumber++,a.length===i.resultNumber&&(r.getMaterialPageList(),i.resultNumber=0)}))},beforeUpload:function(t){var e=t.name,a=/^.+(.png|.jpg|.jpeg|.bmp|.gif)$/;if(!a.test(e))return this.$message.error("上传图片只能是 JPG、JPEG、PNG、GIF 格式!"),!1;var i=t.size,r=this.settings.fileSize;return!(i>r)||(this.$message.error("单张图片最大上传不能超过"+r/1024/1024+"M"),!1)},handleError:function(t){var e=JSON.parse(t.message);this.$message.error(e.message)},moveMaterial:function(t,e){if("up"===e){var a=this.value[t-1];this.$set(this.value,t-1,this.value[t]),this.$set(this.value,t,a)}else if("down"===e){var i=this.value[t+1];this.$set(this.value,t+1,this.value[t]),this.$set(this.value,t,i)}},zoomMaterial:function(t){this.dialogVisible=!0,this.url=this.value[t].realUrl},deleteMaterial:function(t){var e=this;this.$confirm("是否确认删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.value.splice(t,1),e.urls.splice(t,1)}))},toSelectMaterial:function(){this.listDialogVisible=!0,this.tableData.length<=0&&this.getMaterialGroupInfo()},getMaterialGroupInfo:function(){var t=this;this.materialGroupLoading=!0,this.$axios({method:"post",url:"/materialGroup/getMaterialGroupList"}).then((function(e){t.materialGroupLoading=!1;var a=e.data.data;a.unshift({id:0,name:"全部分组"}),t.materialGroupList=a,t.tabClick({index:0})})).catch((function(){t.materialGroupLoading=!1}))},tabClick:function(t){this.urls=[];var e=Number(t.index),a=this.materialGroupList[e];a.index=e,this.materialGroupObj=a,this.materialGroupObjId=a.id+"",this.page.current=1,this.page.total=0,0!==a.id?this.groupId=a.id:this.groupId=0,this.getMaterialPageList()},getMaterialPageList:function(){var t=this;this.tableLoading=!0,this.$axios({method:"post",url:"/material/getMaterialList",data:{groupId:this.groupId,pageNum:this.page.current,pageSize:this.page.pageSize}}).then((function(e){var a=e.data.data.list;t.page.total=e.data.data.total,t.page.current=e.data.data.pageNum,t.page.pageSize=e.data.data.pageSize,t.tableData=a,t.tableLoading=!1})).catch((function(){t.tableLoading=!1}))},materialGroupAdd:function(){var t=this,e=this;this.$prompt("请输入分组名","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"text",inputValidator:function(t){if(!t.trim())return"分组名不能为空"},beforeClose:function(t,e,a){"confirm"===t?e.$refs["confirm"].$el.onclick=function(t){t=t||window.event,0!==t.detail&&a()}():a()}}).then((function(a){var i=a.value;t.$axios({method:"post",url:"/materialGroup/addMaterialGroup",params:{groupName:i.trim()}}).then((function(){e.getMaterialGroupInfo()}))}))},materialGroupEdit:function(t){var e=this,a=this;this.$prompt("请输入分组名","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:t.name,inputType:"text",inputValidator:function(t){if(!t.trim())return"分组名不能为空"},beforeClose:function(t,e,a){"confirm"===t?e.$refs["confirm"].$el.onclick=function(t){t=t||window.event,0!==t.detail&&a()}():a()}}).then((function(i){var r=i.value;e.$axios({method:"post",url:"/materialGroup/updateMaterialGroup",data:{id:t.id,name:r.trim()}}).then((function(){t.name=r,a.$set(a.materialGroupList,t.index,t)}))}))},materialGroupDelete:function(t){var e=this,a=this;this.$confirm("是否确定删除该分组？（该操作会同时删除该分组下得所有素材，且不可逆）","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$axios({method:"post",url:"/materialGroup/deleteMaterialGroup",params:{id:t.id}}).then((function(){a.$delete(a.materialGroupList,t.index),a.tabClick({index:0})}))}))}}},o=n,s=(a("2d3f"),a("2877")),u=Object(s["a"])(o,i,r,!1,null,"6c7395c4",null);e["a"]=u.exports},"2d3f":function(t,e,a){"use strict";a("f11e")},"408a":function(t,e,a){var i=a("e330");t.exports=i(1..valueOf)},"498a":function(t,e,a){"use strict";var i=a("23e7"),r=a("58a8").trim,l=a("c8d2");i({target:"String",proto:!0,forced:l("trim")},{trim:function(){return r(this)}})},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,a){var i=a("e330"),r=a("1d80"),l=a("577e"),n=a("5899"),o=i("".replace),s="["+n+"]",u=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),p=function(t){return function(e){var a=l(r(e));return 1&t&&(a=o(a,u,"")),2&t&&(a=o(a,c,"")),a}};t.exports={start:p(1),end:p(2),trim:p(3)}},"6d02":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"before-close":t.cancel,visible:t.dialog,title:t.isEdit?"编辑":"新增",width:"460px"},on:{"update:visible":function(e){t.dialog=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,size:"small","label-width":"110px"}},[a("el-form-item",{attrs:{label:"轮播图标题",prop:"title"}},[a("el-input",{staticStyle:{width:"300px"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title","string"===typeof e?e.trim():e)},expression:"form.title"}})],1),a("el-form-item",{attrs:{label:"轮播图路由",prop:"url"}},[a("el-input",{staticStyle:{width:"300px"},model:{value:t.form.url,callback:function(e){t.$set(t.form,"url","string"===typeof e?e.trim():e)},expression:"form.url"}})],1),a("el-form-item",{attrs:{label:"轮播图",prop:"image"}},[a("material-list",{attrs:{type:"image",num:1,width:150,height:150},model:{value:t.form.imageArr,callback:function(e){t.$set(t.form,"imageArr","string"===typeof e?e.trim():e)},expression:"form.imageArr"}})],1),a("el-form-item",{attrs:{label:"启用",prop:"enable"}},[a("el-radio-group",{model:{value:t.form.enable,callback:function(e){t.$set(t.form,"enable",e)},expression:"form.enable"}},[a("el-radio",{attrs:{label:"1"}},[t._v("是")]),a("el-radio",{staticStyle:{width:"90px"},attrs:{label:"0"}},[t._v("否")])],1)],1),a("el-form-item",{attrs:{label:"排序",prop:"sort"}},[a("el-input-number",{attrs:{min:1,max:99},model:{value:t.form.sort,callback:function(e){t.$set(t.form,"sort",e)},expression:"form.sort"}})],1)],1),a("div",{staticClass:"dialog-footer",staticStyle:{"margin-right":"10px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"text"},on:{click:t.cancel}},[t._v("取消")]),a("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.doSubmit}},[t._v("确认")])],1)],1)},r=[],l=(a("a15b"),a("2075")),n={name:"rotationInfo",components:{materialList:l["a"]},props:{isEdit:{type:Boolean,required:!0,default:!1}},data:function(){return{loading:!1,dialog:!1,form:{id:null,title:"",image:"",imageArr:[],url:"",enable:"1",sort:0},rules:{title:[{required:!0,message:"请输入轮播图标题",trigger:"blur"}],url:[{required:!0,message:"请输入轮播图路由",trigger:"blur"}]}}},watch:{"form.imageArr":function(t){this.form.image=t.join(",")}},methods:{cancel:function(){this.resetForm()},doSubmit:function(){var t=this;this.$refs["form"].validate((function(e){return!!e&&(0===t.form.imageArr.length?(t.$message.error("请添加轮播图图片"),!1):(t.form.image=t.form.imageArr[0].url,t.loading=!0,void t.$axios({method:"post",url:"/rotation/saveRotationInfo",data:t.form}).then((function(e){200===e.data.code&&(t.$message.success("保存成功"),t.resetForm(),t.$parent.init()),t.loading=!1})).catch((function(){t.loading=!1}))))}))},resetForm:function(){this.dialog=!1,this.$refs["form"].resetFields(),this.form={id:null,title:"",image:"",imageArr:[],url:"",enable:"1",sort:0}}}},o=n,s=a("2877"),u=Object(s["a"])(o,i,r,!1,null,"2ac72482",null);e["default"]=u.exports},7156:function(t,e,a){var i=a("1626"),r=a("861d"),l=a("d2bb");t.exports=function(t,e,a){var n,o;return l&&i(n=e.constructor)&&n!==a&&r(o=n.prototype)&&o!==a.prototype&&l(t,o),t}},a15b:function(t,e,a){"use strict";var i=a("23e7"),r=a("e330"),l=a("44ad"),n=a("fc6a"),o=a("a640"),s=r([].join),u=l!=Object,c=o("join",",");i({target:"Array",proto:!0,forced:u||!c},{join:function(t){return s(n(this),void 0===t?",":t)}})},a9e3:function(t,e,a){"use strict";var i=a("83ab"),r=a("da84"),l=a("e330"),n=a("94ca"),o=a("6eeb"),s=a("1a2d"),u=a("7156"),c=a("3a9b"),p=a("d9b5"),d=a("c04e"),m=a("d039"),f=a("241c").f,g=a("06cf").f,h=a("9bf2").f,b=a("408a"),v=a("58a8").trim,x="Number",y=r[x],_=y.prototype,G=r.TypeError,w=l("".slice),$=l("".charCodeAt),S=function(t){var e=d(t,"number");return"bigint"==typeof e?e:k(e)},k=function(t){var e,a,i,r,l,n,o,s,u=d(t,"number");if(p(u))throw G("Cannot convert a Symbol value to a number");if("string"==typeof u&&u.length>2)if(u=v(u),e=$(u,0),43===e||45===e){if(a=$(u,2),88===a||120===a)return NaN}else if(48===e){switch($(u,1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+u}for(l=w(u,2),n=l.length,o=0;o<n;o++)if(s=$(l,o),s<48||s>r)return NaN;return parseInt(l,i)}return+u};if(n(x,!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var C,I=function(t){var e=arguments.length<1?0:y(S(t)),a=this;return c(_,a)&&m((function(){b(a)}))?u(Object(e),a,I):e},N=i?f(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),L=0;N.length>L;L++)s(y,C=N[L])&&!s(I,C)&&h(I,C,g(y,C));I.prototype=_,_.constructor=I,o(r,x,I)}},c8d2:function(t,e,a){var i=a("5e77").PROPER,r=a("d039"),l=a("5899"),n="​᠎";t.exports=function(t){return r((function(){return!!l[t]()||n[t]()!==n||i&&l[t].name!==t}))}},f11e:function(t,e,a){}}]);