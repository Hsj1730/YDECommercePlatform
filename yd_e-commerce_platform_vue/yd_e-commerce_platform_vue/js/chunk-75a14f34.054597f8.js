(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-75a14f34","chunk-06140424"],{5958:function(t,e,a){"use strict";a("dee0")},6386:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"head-container",staticStyle:{"margin-top":"-20px"}},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"输入搜索内容"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.toQuery.apply(null,arguments)}},model:{value:t.query.value,callback:function(e){t.$set(t.query,"value",e)},expression:"query.value"}}),a("el-select",{staticClass:"filter-item",staticStyle:{width:"150px","padding-left":"10px"},attrs:{clearable:"",placeholder:"类型"},model:{value:t.query.type,callback:function(e){t.$set(t.query,"type",e)},expression:"query.type"}},t._l(t.queryTypeOptions,(function(t){return a("el-option",{key:t.key,attrs:{label:t.display_name,value:t.key}})})),1),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{size:"mini",type:"success",icon:"el-icon-search"},on:{click:t.toQuery}},[t._v("搜索")]),a("div",{staticStyle:{display:"inline-block",margin:"0 0 0 10px"}},[a("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:t.add}},[t._v("新增")]),a("el-button",{staticClass:"filter-item",attrs:{type:"danger",size:"mini",icon:"el-icon-refresh"},on:{click:t.reset}},[t._v("重置")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,size:"small"}},[a("el-table-column",{attrs:{prop:"id",align:"center",width:"80",label:"商品id"}}),a("el-table-column",{ref:"table",attrs:{align:"center",width:"150",prop:"image",label:"商品图片"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("a",{staticStyle:{color:"#42b983"},attrs:{href:t.row.image,target:"_blank"}},[a("img",{staticClass:"el-avatar",attrs:{src:t.row.image,alt:"点击打开"}})])]}}])}),a("el-table-column",{attrs:{prop:"storeName",align:"center",label:"商品名称"}}),a("el-table-column",{attrs:{prop:"barCode",align:"center",width:"100",label:"商品编码"}}),a("el-table-column",{attrs:{prop:"cateName",align:"center",width:"100",label:"分类名称"}}),a("el-table-column",{attrs:{prop:"price",align:"center",width:"100",label:"商品价格",sortable:""}}),a("el-table-column",{attrs:{prop:"sales",align:"center",width:"100",label:"销量",sortable:""}}),a("el-table-column",{attrs:{prop:"stock",align:"center",width:"100",label:"库存",sortable:""}}),a("el-table-column",{attrs:{label:"状态",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{on:{click:function(a){return t.onSale(e.row.id,e.row.isShow)}}},["1"===e.row.isShow?a("el-tag",{staticStyle:{cursor:"pointer"}},[t._v("已上架")]):a("el-tag",{staticStyle:{cursor:"pointer"},attrs:{type:"info"}},[t._v("已下架")])],1)]}}])}),a("el-table-column",{attrs:{align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{slot:"reference",type:"danger",size:"mini"},on:{click:function(a){return t.attr(e.row.id)}},slot:"reference"},[t._v("规格属性")]),a("el-dropdown",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini","split-button":"",type:"primary",trigger:"click"}},[t._v(" 操作 "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(a){return t.edit(e.row.id)}}},[t._v("编辑")])],1),a("el-dropdown-item",[a("el-popover",{ref:e.row.id,attrs:{placement:"top",width:"180"}},[a("p",[t._v("确定删除本条数据吗？")]),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){t.$refs[e.row.id].doClose()}}},[t._v("取消")]),a("el-button",{attrs:{loading:t.delLoading,type:"primary",size:"mini"},on:{click:function(a){return t.subDelete(e.row.id)}}},[t._v("确定")])],1),a("el-button",{attrs:{slot:"reference",type:"danger",icon:"el-icon-delete",size:"mini"},slot:"reference"},[t._v("删除")])],1)],1)],1)],1)]}}])},[a("template",{slot:"header"},[a("div",{staticStyle:{display:"inline-block",cursor:"pointer"},on:{click:t.toQuery}},[t._v(" 操作"),a("i",{staticClass:"el-icon-refresh",staticStyle:{"margin-left":"10px"}})])])],2)],1),a("el-pagination",{staticStyle:{float:"right","margin-top":"10px","padding-bottom":"10px"},attrs:{"current-page":t.page.current,"page-sizes":[10,20,50,100],"page-size":t.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.page.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),a("goods-info",{ref:"goodsInfoForm",attrs:{"is-edit":t.isEdit}}),a("attr",{ref:"attr",attrs:{"is-attr":t.isAttr}})],1)},n=[],s=a("8844"),r=a("da4f"),o={name:"onSale",components:{goodsInfo:s["default"],attr:r["default"]},data:function(){return{query:{value:"",type:"storeName"},queryTypeOptions:[{key:"storeName",display_name:"商品名称"},{key:"cateName",display_name:"分类名称"},{key:"barCode",display_name:"商品编码"}],loading:!1,delLoading:!1,isEdit:!1,isAttr:!1,tableData:[],page:{current:1,pageSize:10,total:0}}},created:function(){this.init()},methods:{attr:function(t){this.isAttr=!1,this.$refs.attr.dialog=!0,this.$refs.attr.id=t,this.$refs.attr.getAttrs()},add:function(){this.isEdit=!1,this.$refs.goodsInfoForm.dialog=!0,this.$refs.goodsInfoForm.getCateTree()},edit:function(t){var e=this;this.isEdit=!0,this.$refs.goodsInfoForm.dialog=!0,this.$refs.goodsInfoForm.getCateTree(),this.$axios({method:"post",url:"/goods/getGoodsInfo/"+t}).then((function(t){e.$refs.goodsInfoForm.form=t.data.data}))},subDelete:function(t){var e=this;this.delLoading=!0,this.$axios({method:"post",url:"/goods/deleteGoods/"+t}).then((function(t){200===t.data.code&&(e.delLoading=!1,e.$message.success("删除成功"),e.toQuery())})).catch((function(){e.delLoading=!1}))},onSale:function(t,e){var a=this;this.$confirm("确定进行[ ".concat("1"===e?"下架":"上架"," ]操作?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.$axios({method:"post",url:"/goods/setGoodsIsShow/"+t,params:{status:"1"===e?"0":"1"}}).then((function(){a.$message({message:"操作成功",type:"success",duration:1e3,onClose:function(){a.toQuery()}})}))}))},init:function(){this.page={current:1,pageSize:10,total:0},this.toQuery()},reset:function(){this.query={value:"",type:"storeName"},this.init()},toQuery:function(){var t=this;this.loading=!0,this.$axios({method:"post",url:"/goods/getGoodsList",data:{query:this.query,pageNum:this.page.current,pageSize:this.page.pageSize,isShow:"1"}}).then((function(e){t.loading=!1,t.tableData=e.data.data.list,t.page.total=e.data.data.total,t.page.current=e.data.data.pageNum,t.page.pageSize=e.data.data.pageSize})).catch((function(){t.loading=!1}))},handleSizeChange:function(t){this.page.pageSize=t,this.toQuery()},handleCurrentChange:function(t){this.page.current=t,this.toQuery()}}},l=o,c=a("2877"),d=Object(c["a"])(l,i,n,!1,null,"39417ecf",null);e["default"]=d.exports},b64b:function(t,e,a){var i=a("23e7"),n=a("7b0b"),s=a("df75"),r=a("d039"),o=r((function(){s(1)}));i({target:"Object",stat:!0,forced:o},{keys:function(t){return s(n(t))}})},da4f:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"before-close":t.cancel,visible:t.dialog,title:t.title,width:"900px"},on:{"update:visible":function(e){t.dialog=e}}},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:!1===t.hidden,expression:"hidden === false"}],attrs:{inline:!0,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"规则名称"}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:10}},[a("el-button",{attrs:{type:"primary"},on:{click:t.hiddenBool}},[t._v("添加新规则")])],1)],1)],1)],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:!0===t.hidden,expression:"hidden === true"}],attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"规则名称"}},[a("el-row",{attrs:{gutter:10}},[t._l(t.items,(function(e,i){return a("el-col",{key:i,staticStyle:{position:"relative","margin-right":"6px"},attrs:{span:5}},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"设置名称"},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!0===e.attrHidden,expression:"item.attrHidden === true"}],staticStyle:{position:"absolute",top:"-6px",right:"17px","margin-top":"1px",border:"none","font-size":"14px","font-weight":"bold","line-height":"1.8"},attrs:{type:"text",icon:"el-icon-close"},on:{click:function(e){return t.handleRemove(i)}}}),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!1===e.attrHidden,expression:"item.attrHidden === false"}],staticStyle:{position:"absolute",top:"-6px",right:"17px","margin-top":"1px",border:"none","font-size":"14px","font-weight":"bold","line-height":"1.8"},attrs:{type:"text",icon:"el-icon-check"},on:{click:function(a){return t.attrHiddenBool(e)}}})],1)})),a("el-col",{attrs:{span:5}},[a("el-button",{attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v("添加新规则")])],1)],2)],1),t._l(t.items,(function(e,i){return a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!0===e.attrHidden,expression:"item.attrHidden === true"}],key:i,attrs:{label:e.value+":"}},[a("el-row",{attrs:{gutter:13}},[t._l(e.detail,(function(i,n){return a("el-col",{key:i,attrs:{span:3,name:i}},[a("el-tag",{attrs:{closable:""},on:{close:function(a){return t.attrRemove(e,n)}}},[t._v(t._s(i))])],1)})),a("el-col",{attrs:{span:5}},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"设置属性"},model:{value:e.detailValue,callback:function(a){t.$set(e,"detailValue",a)},expression:"item.detailValue"}})],1),a("el-col",{attrs:{span:5}},[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.attrAdd(e)}}},[t._v("添加")])],1)],2)],1)})),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!0===t.hidden,expression:"hidden === true"}]},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:24}},[a("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.addGoods}},[t._v("生成")])],1)],1)],1),""!==t.items[0].value&&t.items[0].detail.length>0&&t.attrs.length?[t._l(t.attrs,(function(e,i){return[a("el-form-item",[a("el-row",{attrs:{gutter:24}},[t._l(e.detail,(function(e,i){return[a("el-col",{staticStyle:{"margin-right":"2px"},attrs:{span:3}},[t._v(" "+t._s(i)+":"+t._s(e)+" ")])]})),a("el-col",{attrs:{span:4}},[a("span",{class:e.check?"check":""},[t._v("金额:")]),t._v("  "),a("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"金额",number:!0},model:{value:e.price,callback:function(a){t.$set(e,"price",a)},expression:"attr.price"}})],1),a("el-col",{attrs:{span:4}},[a("span",{class:e.check?"check":""},[t._v("库存:")]),t._v("  "),a("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"库存",number:!0},model:{value:e.sales,callback:function(a){t.$set(e,"sales",a)},expression:"attr.sales"}})],1),a("el-col",{attrs:{span:5}},[a("span",{class:e.check?"check":""},[t._v("成本价:")]),t._v("  "),a("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"成本价",number:!0},model:{value:e.cost,callback:function(a){t.$set(e,"cost",a)},expression:"attr.cost"}})],1),a("el-col",{staticStyle:{"margin-right":"2px"},attrs:{span:3}},[a("div",{staticClass:"demo-upload"},[a("pic-upload-two",{model:{value:e.pic,callback:function(a){t.$set(e,"pic",a)},expression:"attr.pic"}})],1)]),a("el-col",{staticStyle:{"margin-right":"3px"},attrs:{span:2}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.removeGoods(i)}}},[t._v("删除")])],1)],2)],1)]}))]:t._e()],2)],1)},n=[],s=(a("a434"),a("d81d"),a("b64b"),a("5c96")),r={name:"attr",components:{},props:{isAttr:{type:Boolean,required:!0}},data:function(){return{loading:!1,dialog:!1,title:"规则属性",items:[{value:"",detailValue:"",attrHidden:!1,detail:[]}],attrs:[],hidden:!1,id:null}},methods:{getAttrs:function(){var t=this;this.$axios({method:"post",url:"/goods/getAttrs/"+this.id}).then((function(e){200===e.data.code&&(e.data.data?(t.hidden=!0,t.items=e.data.data.attr,t.attrs=e.data.data.value):(t.hidden=!1,t.items=[{value:"",detailValue:"",attrHidden:!1,detail:[]}],t.attrs=[]))}))},removeGoods:function(t){this.attrs.splice(t,1)},cancel:function(){this.resetForm()},resetForm:function(){this.dialog=!1},hiddenBool:function(){this.hidden=!0},handleRemove:function(t){this.items.length>1?this.items.splice(t,1):Object(s["Message"])({message:"请设置至少一个规则",type:"error"})},attrHiddenBool:function(t){""===t.value?Object(s["Message"])({message:"请填写规则名称",type:"error"}):t.attrHidden=!0},handleAdd:function(){this.checkAttr()&&this.items.push({value:"",detailValue:"",attrHidden:!1,detail:[]})},checkAttr:function(){var t=!0;return this.items.map((function(e){t&&(e.value?e.detail.length||(Object(s["Message"])({message:"请设置规则属性",type:"error"}),t=!1):(Object(s["Message"])({message:"请填写规则名称",type:"error"}),t=!1))})),t},attrRemove:function(t,e){if(1===t.detail.length)return Object(s["Message"])({message:"请设置至少一个属性",type:"error"}),!1;t.detail.splice(e,1)},attrAdd:function(t){if(!t.detailValue)return!1;t.detail.push(t.detailValue),t.detailValue=""},addGoods:function(){var t=this;this.attrs.length&&!this.checkGoods()||(this.loading=!0,this.$axios({method:"post",url:"/goods/isFormatAttr/"+this.id,data:{items:this.items,attrs:this.attrs}}).then((function(e){200===e.data.code&&(t.attrs=e.data.data,t.loading=!1)})).catch((function(){t.loading=!1})))},checkGoods:function(){var t=!0;return this.attrs.map((function(e){t&&(Object.keys(e.detail).length?e.price!==parseFloat(e.price)||e.price<0?(Object(s["Message"])({message:"请输入正确的商品价格",type:"error"}),t=!1):(e.sales!==parseInt(e.sales)||e.sales<0)&&(Object(s["Message"])({message:"请输入正确的商品库存",type:"error"}),t=!1):(Object(s["Message"])({message:"请选择至少一个属性",type:"error"}),t=!1))})),t}}},o=r,l=(a("5958"),a("2877")),c=Object(l["a"])(o,i,n,!1,null,"da1b4474",null);e["default"]=c.exports},dee0:function(t,e,a){}}]);