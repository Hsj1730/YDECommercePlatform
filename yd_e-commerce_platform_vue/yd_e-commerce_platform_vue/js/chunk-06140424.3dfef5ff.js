(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-06140424"],{5958:function(t,e,a){"use strict";a("dee0")},b64b:function(t,e,a){var i=a("23e7"),s=a("7b0b"),r=a("df75"),n=a("d039"),l=n((function(){r(1)}));i({target:"Object",stat:!0,forced:l},{keys:function(t){return r(s(t))}})},da4f:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"before-close":t.cancel,visible:t.dialog,title:t.title,width:"900px"},on:{"update:visible":function(e){t.dialog=e}}},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:!1===t.hidden,expression:"hidden === false"}],attrs:{inline:!0,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"规则名称"}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:10}},[a("el-button",{attrs:{type:"primary"},on:{click:t.hiddenBool}},[t._v("添加新规则")])],1)],1)],1)],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:!0===t.hidden,expression:"hidden === true"}],attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"规则名称"}},[a("el-row",{attrs:{gutter:10}},[t._l(t.items,(function(e,i){return a("el-col",{key:i,staticStyle:{position:"relative","margin-right":"6px"},attrs:{span:5}},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"设置名称"},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!0===e.attrHidden,expression:"item.attrHidden === true"}],staticStyle:{position:"absolute",top:"-6px",right:"17px","margin-top":"1px",border:"none","font-size":"14px","font-weight":"bold","line-height":"1.8"},attrs:{type:"text",icon:"el-icon-close"},on:{click:function(e){return t.handleRemove(i)}}}),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!1===e.attrHidden,expression:"item.attrHidden === false"}],staticStyle:{position:"absolute",top:"-6px",right:"17px","margin-top":"1px",border:"none","font-size":"14px","font-weight":"bold","line-height":"1.8"},attrs:{type:"text",icon:"el-icon-check"},on:{click:function(a){return t.attrHiddenBool(e)}}})],1)})),a("el-col",{attrs:{span:5}},[a("el-button",{attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v("添加新规则")])],1)],2)],1),t._l(t.items,(function(e,i){return a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!0===e.attrHidden,expression:"item.attrHidden === true"}],key:i,attrs:{label:e.value+":"}},[a("el-row",{attrs:{gutter:13}},[t._l(e.detail,(function(i,s){return a("el-col",{key:i,attrs:{span:3,name:i}},[a("el-tag",{attrs:{closable:""},on:{close:function(a){return t.attrRemove(e,s)}}},[t._v(t._s(i))])],1)})),a("el-col",{attrs:{span:5}},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"设置属性"},model:{value:e.detailValue,callback:function(a){t.$set(e,"detailValue",a)},expression:"item.detailValue"}})],1),a("el-col",{attrs:{span:5}},[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.attrAdd(e)}}},[t._v("添加")])],1)],2)],1)})),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!0===t.hidden,expression:"hidden === true"}]},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:24}},[a("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.addGoods}},[t._v("生成")])],1)],1)],1),""!==t.items[0].value&&t.items[0].detail.length>0&&t.attrs.length?[t._l(t.attrs,(function(e,i){return[a("el-form-item",[a("el-row",{attrs:{gutter:24}},[t._l(e.detail,(function(e,i){return[a("el-col",{staticStyle:{"margin-right":"2px"},attrs:{span:3}},[t._v(" "+t._s(i)+":"+t._s(e)+" ")])]})),a("el-col",{attrs:{span:4}},[a("span",{class:e.check?"check":""},[t._v("金额:")]),t._v("  "),a("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"金额",number:!0},model:{value:e.price,callback:function(a){t.$set(e,"price",a)},expression:"attr.price"}})],1),a("el-col",{attrs:{span:4}},[a("span",{class:e.check?"check":""},[t._v("库存:")]),t._v("  "),a("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"库存",number:!0},model:{value:e.sales,callback:function(a){t.$set(e,"sales",a)},expression:"attr.sales"}})],1),a("el-col",{attrs:{span:5}},[a("span",{class:e.check?"check":""},[t._v("成本价:")]),t._v("  "),a("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"成本价",number:!0},model:{value:e.cost,callback:function(a){t.$set(e,"cost",a)},expression:"attr.cost"}})],1),a("el-col",{staticStyle:{"margin-right":"2px"},attrs:{span:3}},[a("div",{staticClass:"demo-upload"},[a("pic-upload-two",{model:{value:e.pic,callback:function(a){t.$set(e,"pic",a)},expression:"attr.pic"}})],1)]),a("el-col",{staticStyle:{"margin-right":"3px"},attrs:{span:2}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.removeGoods(i)}}},[t._v("删除")])],1)],2)],1)]}))]:t._e()],2)],1)},s=[],r=(a("a434"),a("d81d"),a("b64b"),a("5c96")),n={name:"attr",components:{},props:{isAttr:{type:Boolean,required:!0}},data:function(){return{loading:!1,dialog:!1,title:"规则属性",items:[{value:"",detailValue:"",attrHidden:!1,detail:[]}],attrs:[],hidden:!1,id:null}},methods:{getAttrs:function(){var t=this;this.$axios({method:"post",url:"/goods/getAttrs/"+this.id}).then((function(e){200===e.data.code&&(e.data.data?(t.hidden=!0,t.items=e.data.data.attr,t.attrs=e.data.data.value):(t.hidden=!1,t.items=[{value:"",detailValue:"",attrHidden:!1,detail:[]}],t.attrs=[]))}))},removeGoods:function(t){this.attrs.splice(t,1)},cancel:function(){this.resetForm()},resetForm:function(){this.dialog=!1},hiddenBool:function(){this.hidden=!0},handleRemove:function(t){this.items.length>1?this.items.splice(t,1):Object(r["Message"])({message:"请设置至少一个规则",type:"error"})},attrHiddenBool:function(t){""===t.value?Object(r["Message"])({message:"请填写规则名称",type:"error"}):t.attrHidden=!0},handleAdd:function(){this.checkAttr()&&this.items.push({value:"",detailValue:"",attrHidden:!1,detail:[]})},checkAttr:function(){var t=!0;return this.items.map((function(e){t&&(e.value?e.detail.length||(Object(r["Message"])({message:"请设置规则属性",type:"error"}),t=!1):(Object(r["Message"])({message:"请填写规则名称",type:"error"}),t=!1))})),t},attrRemove:function(t,e){if(1===t.detail.length)return Object(r["Message"])({message:"请设置至少一个属性",type:"error"}),!1;t.detail.splice(e,1)},attrAdd:function(t){if(!t.detailValue)return!1;t.detail.push(t.detailValue),t.detailValue=""},addGoods:function(){var t=this;this.attrs.length&&!this.checkGoods()||(this.loading=!0,this.$axios({method:"post",url:"/goods/isFormatAttr/"+this.id,data:{items:this.items,attrs:this.attrs}}).then((function(e){200===e.data.code&&(t.attrs=e.data.data,t.loading=!1)})).catch((function(){t.loading=!1})))},checkGoods:function(){var t=!0;return this.attrs.map((function(e){t&&(Object.keys(e.detail).length?e.price!==parseFloat(e.price)||e.price<0?(Object(r["Message"])({message:"请输入正确的商品价格",type:"error"}),t=!1):(e.sales!==parseInt(e.sales)||e.sales<0)&&(Object(r["Message"])({message:"请输入正确的商品库存",type:"error"}),t=!1):(Object(r["Message"])({message:"请选择至少一个属性",type:"error"}),t=!1))})),t}}},l=n,o=(a("5958"),a("2877")),c=Object(o["a"])(l,i,s,!1,null,"da1b4474",null);e["default"]=c.exports},dee0:function(t,e,a){}}]);