(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3e0749f8"],{"99af":function(e,t,o){"use strict";var n=o("23e7"),a=o("da84"),r=o("d039"),l=o("e8b5"),i=o("861d"),s=o("7b0b"),c=o("07fa"),u=o("8418"),d=o("65f0"),f=o("1dde"),m=o("b622"),h=o("2d00"),p=m("isConcatSpreadable"),g=9007199254740991,b="Maximum allowed index exceeded",v=a.TypeError,y=h>=51||!r((function(){var e=[];return e[p]=!1,e.concat()[0]!==e})),k=f("concat"),x=function(e){if(!i(e))return!1;var t=e[p];return void 0!==t?!!t:l(e)},D=!y||!k;n({target:"Array",proto:!0,forced:D},{concat:function(e){var t,o,n,a,r,l=s(this),i=d(l,0),f=0;for(t=-1,n=arguments.length;t<n;t++)if(r=-1===t?l:arguments[t],x(r)){if(a=c(r),f+a>g)throw v(b);for(o=0;o<a;o++,f++)o in r&&u(i,f,r[o])}else{if(f>=g)throw v(b);u(i,f++,r)}return i.length=f,i}})},b64b:function(e,t,o){var n=o("23e7"),a=o("7b0b"),r=o("df75"),l=o("d039"),i=l((function(){r(1)}));n({target:"Object",stat:!0,forced:i},{keys:function(e){return r(a(e))}})},bcec:function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-form",{attrs:{inline:!0,model:e.searchForm}},[o("el-form-item",[o("el-input",{attrs:{placeholder:"请输入角色名称进行搜索",clearable:""},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1),o("el-form-item",[o("el-button",{attrs:{icon:"el-icon-search"},on:{click:e.getRoleList}},[e._v("搜索")]),o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.fnOpenRoleDialog}},[e._v("新增角色")])],1)],1),o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark",border:"",stripe:""}},[o("el-table-column",{attrs:{prop:"name",align:"center",label:"角色名称",width:"200"}}),o("el-table-column",{attrs:{prop:"code",label:"角色编码",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-tag",{attrs:{type:"info"}},[e._v(e._s(t.row.code))])]}}])}),o("el-table-column",{attrs:{prop:"enable",width:"100",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"===t.row.enable?o("el-tag",{attrs:{type:"success"}},[e._v("启用")]):"0"===t.row.enable?o("el-tag",{attrs:{type:"danger"}},[e._v("禁用")]):e._e()]}}])}),o("el-table-column",{attrs:{prop:"createTime",width:"180",align:"center",label:"创建时间"}}),o("el-table-column",{attrs:{prop:"action",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"text"},on:{click:function(o){return e.fnOpenMenuDialog(t.row.id)}}},[e._v("分配菜单")]),o("el-button",{attrs:{type:"text"},on:{click:function(o){return e.fnToEditRole(t.row.id)}}},[e._v("编辑")]),"0"===t.row.enable?o("el-button",{attrs:{type:"text"},on:{click:function(o){return e.fnChangeEnable(t.row.id,"1")}}},[e._v("启用")]):e._e(),"1"===t.row.enable?o("el-button",{attrs:{type:"text"},on:{click:function(o){return e.fnChangeEnable(t.row.id,"0")}}},[e._v("禁用")]):e._e(),o("el-popconfirm",{staticStyle:{"margin-left":"10px"},attrs:{title:"确定要删除吗？"},on:{confirm:function(o){return e.deleteRole(t.row.id)}}},[o("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")])],1)]}}])},[o("template",{slot:"header"},[o("div",{staticStyle:{display:"inline-block",cursor:"pointer"},on:{click:e.getRoleList}},[e._v(" 操作"),o("i",{staticClass:"el-icon-refresh",staticStyle:{"margin-left":"10px"}})])])],2)],1),o("el-pagination",{staticStyle:{float:"right","margin-top":"10px","padding-bottom":"10px"},attrs:{"current-page":e.current,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),o("el-dialog",{attrs:{title:e.isEdit?"修改角色":"新增角色",visible:e.roleDialogVisible,width:"35%"},on:{"update:visible":function(t){e.roleDialogVisible=t},close:function(t){return e.fnCloseRoleDialog("roleForm")}}},[o("el-form",{ref:"roleForm",attrs:{model:e.roleForm}},[o("el-form-item",{attrs:{label:"角色名称：",prop:"name","label-width":"100px",rules:{required:!0,message:"请输入角色名称",trigger:"blur"}}},[o("el-input",{attrs:{placeholder:"请输入角色名称",clearable:""},model:{value:e.roleForm.name,callback:function(t){e.$set(e.roleForm,"name","string"===typeof t?t.trim():t)},expression:"roleForm.name"}})],1),o("el-form-item",{attrs:{label:"角色编码：",prop:"code","label-width":"100px",clearable:"",rules:{required:!0,message:"请输入角色编码",trigger:"blur"}}},[o("el-input",{attrs:{placeholder:"请输入角色编码"},model:{value:e.roleForm.code,callback:function(t){e.$set(e.roleForm,"code","string"===typeof t?t.trim():t)},expression:"roleForm.code"}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){return e.fnCloseRoleDialog("roleForm")}}},[e._v("取 消")]),e.isEdit?e._e():o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.fnAddRole("roleForm")}}},[e._v("新 增")]),e.isEdit?o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.fnEditRole("roleForm")}}},[e._v("编 辑")]):e._e()],1)],1),o("el-dialog",{attrs:{title:"分配菜单",visible:e.menuDialogVisible,width:"35%"},on:{"update:visible":function(t){e.menuDialogVisible=t},close:e.fnCloseMenuDialog}},[o("el-tree",{ref:"menuTree",attrs:{data:e.menuTreeData,"show-checkbox":"","default-expand-all":!0,"node-key":"id","expand-on-click-node":!0,props:e.defaultProps,"check-strictly":e.status}}),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:e.fnCloseMenuDialog}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.fnAssignMenu}},[e._v("确 定")])],1)],1)],1)},a=[],r=(o("b0c0"),o("d3b7"),o("159b"),o("b64b"),o("99af"),o("1163")),l=o("4360"),i={name:"role",data:function(){return{searchForm:{name:""},tableData:[],current:1,pageSize:10,total:0,roleDialogVisible:!1,roleForm:{id:0,name:"",code:""},isEdit:!1,menuDialogVisible:!1,menuTreeData:[],defaultProps:{children:"children",label:"name"},roleId:0,status:!1}},methods:{getRoleList:function(){var e=this;this.$axios({method:"post",url:"/role/getRoleList",data:{pageNum:this.current,pageSize:this.pageSize,name:this.searchForm.name}}).then((function(t){e.tableData=t.data.data.list,e.total=t.data.data.total}))},fnOpenRoleDialog:function(){this.roleDialogVisible=!0,this.isEdit=!1},fnOpenMenuDialog:function(e){var t=this;this.roleId=e,this.status=!0,this.$axios({method:"post",url:"/role/getMenuTree",params:{id:e}}).then((function(e){t.menuDialogVisible=!0,t.$nextTick((function(){t.menuTreeData=e.data.data.menuTree,t.$refs.menuTree.setCheckedKeys(e.data.data.menuIds),t.$nextTick((function(){t.status=!1}))}))}))},fnToEditRole:function(e){var t=this;this.$axios({method:"post",url:"/role/getRoleById",params:{id:e}}).then((function(e){t.roleForm=e.data.data,t.isEdit=!0,t.roleDialogVisible=!0}))},fnChangeEnable:function(e,t){var o=this;this.$axios({method:"post",url:"/role/changeEnable",data:{id:e,enable:t}}).then((function(e){200===e.data.code&&(o.$message.success(e.data.msg),o.getRoleList())}))},deleteRole:function(e){var t=this;this.$axios({method:"post",url:"/role/deleteRole",params:{id:e}}).then((function(e){200===e.data.code&&(t.$message.success("删除成功"),t.getRoleList())}))},handleSizeChange:function(e){this.pageSize=e,this.getRoleList()},handleCurrentChange:function(e){this.current=e,this.getRoleList()},fnCloseRoleDialog:function(e){var t=this;this.$refs[e].resetFields(),Object.keys(this.roleForm).forEach((function(e){return t.roleForm[e]=""})),this.roleDialogVisible=!1},fnAddRole:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.$axios({method:"post",url:"/role/addRole",data:t.roleForm}).then((function(){t.$message.success("新增成功"),t.roleDialogVisible=!1,t.getRoleList()}))}))},fnEditRole:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.$axios({method:"post",url:"/role/editRole",data:t.roleForm}).then((function(){t.$message.success("编辑成功"),t.roleDialogVisible=!1,t.getRoleList()}))}))},fnCloseMenuDialog:function(){this.roleId=0,this.$refs.menuTree.setCheckedKeys([]),this.menuDialogVisible=!1},fnAssignMenu:function(){var e=this;this.$axios({method:"post",url:"/role/saveRoleMenu",data:{roleId:this.roleId,menuIds:[].concat(this.$refs.menuTree.getHalfCheckedKeys(),this.$refs.menuTree.getCheckedKeys())}}).then((function(t){0===t.data.data?e.$message.error("分配失败！"):(e.$message.success("分配成功"),e.roleId=0,e.$refs.menuTree.setCheckedKeys([]),e.menuDialogVisible=!1,r["a"].post("user/getMenuList").then((function(e){l["a"].commit("setMenuList",e.data.data)})))}))}},mounted:function(){this.getRoleList()}},s=i,c=o("2877"),u=Object(c["a"])(s,n,a,!1,null,"d0cdc092",null);t["default"]=u.exports}}]);